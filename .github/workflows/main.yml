name: BrainAI Industrial PDF Build

on: 
  push:
    paths:
      - 'docs/**'
  workflow_dispatch:

jobs:
  build-pdfs:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Install Industrial Rendering Stack
        run: |
          sudo apt-get update
          sudo apt-get install -y wkhtmltopdf
          pip install grip

      - name: Create Build Directory
        run: mkdir -p build

      - name: Render MD to Industrial PDF
        run: |
          for f in docs/*.md; do
            filename=$(basename "$f" .md)
            echo "Processing $filename..."
            # 1. MD zu HTML (GitHub Style)
            grip "$f" --export "build/${filename}.html"
            # 2. HTML zu PDF (Professional Layout)
            wkhtmltopdf --enable-local-file-access \
                        --page-size A4 \
                        --margin-top 20mm \
                        --margin-bottom 20mm \
                        --footer-right "[page] / [topage]" \
                        "build/${filename}.html" "build/${filename}.pdf"
          done

      - name: Archive Production Docs
        uses: actions/upload-artifact@v4
        with:
          name: ProEDC-Manuals-Final
          path: build/*.pdf
